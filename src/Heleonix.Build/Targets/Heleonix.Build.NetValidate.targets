<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Target Name="Hx_NetValidate">
    <Message Text="> STARTING..."/>

    <MSBuild
      Condition="'@(Hx_NetValidate_Files)' == ''"
      Projects="$(MSBuildProjectFullPath)"
      Targets="Hx_Internal_NetFindSln"
      Properties="Hx_Internal_NetFindSln_WSDir=$(Hx_WS_Dir)">
      <Output TaskParameter="TargetOutputs" PropertyName="_Hx_NetValidate_SlnFile"/>
    </MSBuild>

    <MSBuild
      Condition="'@(Hx_NetValidate_Files)' == ''"
      Projects="$(MSBuildProjectFullPath)"
      Targets="Hx_Internal_NetFindProjects"
      Properties="Hx_Internal_NetFindProjects_SlnFile=$(_Hx_NetValidate_SlnFile)">
      <Output TaskParameter="TargetOutputs" ItemName="_Hx_NetValidate_ProjectFiles"/>
    </MSBuild>

    <ItemGroup Condition="'@(Hx_NetValidate_Files)' == ''">
      <Hx_NetValidate_Files Include="%(_Hx_NetValidate_ProjectFiles.FullPath)">
        <CodecrackerCSharp>(?&lt;=&lt;%5Cs*PackageReference%5Cs*Include%5Cs*=%5Cs*")(codecracker.CSharp)</CodecrackerCSharp>
        <FxCopAnalyzers>(?&lt;=&lt;%5Cs*PackageReference%5Cs*Include%5Cs*=%5Cs*")(Microsoft.CodeAnalysis.NetAnalyzers)</FxCopAnalyzers>
        <SecurityCodeScan>(?&lt;=&lt;%5Cs*PackageReference%5Cs*Include%5Cs*=%5Cs*")(SecurityCodeScan.VS2019)</SecurityCodeScan>
        <SonarAnalyzerCSharp>(?&lt;=&lt;%5Cs*PackageReference%5Cs*Include%5Cs*=%5Cs*")(SonarAnalyzer.CSharp)</SonarAnalyzerCSharp>
        <StyleCopAnalyzers>(?&lt;=&lt;%5Cs*PackageReference%5Cs*Include%5Cs*=%5Cs*")(StyleCop.Analyzers)</StyleCopAnalyzers>
      </Hx_NetValidate_Files>
    </ItemGroup>

    <PropertyGroup>
      <Hx_NetValidate_RegExpOptions>IgnoreCase</Hx_NetValidate_RegExpOptions>
    </PropertyGroup>

    <Message Text="> 1/1: Validating files"/>
    <Heleonix.Build.Tasks.FileValidate Files="@(Hx_NetValidate_Files)" RegExpOptions="$(Hx_NetValidate_RegExpOptions)"/>

    <Message Text="> DONE!"/>

    <OnError ExecuteTargets="Hx_OnError"/>
  </Target>
</Project>